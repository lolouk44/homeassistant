title: Car
#background: url("/local/BMW_220d_GT.png") center / contain no-repeat
icon: mdi:car-connected
badges:
  !include /config/lovelace_views/badges.yaml
cards:
  - !include /config/lovelace_views/persistent_notifications.yaml
  - !include /config/lovelace_views/alert_card.yaml
  - type: picture-elements
    state_color: true
    image: /local/BMW_220d_GT_Top_View.png
    elements:
      - type: state-icon
        entity: binary_sensor.220d_door_lock_state
        icon: mdi:car-key
        style:
          top: 5%
          left: 7%
      - type: icon
        icon: mdi:lock
        tap_action:
          action: call-service
          service: lock.lock
          service_data:
            entity_id: lock.220d_lock
        style:
          top: 12%
          left: 7%
          color: Tomato
      - type: icon
        icon: mdi:lock-open
        tap_action:
          action: call-service
          service: lock.unlock
          service_data:
            entity_id: lock.220d_lock
        style:
          top: 19%
          left: 7%
          color: Tomato
      - type: icon
        icon: mdi:car-light-dimmed
        tap_action:
          action: call-service
          service: button.press
          service_data:
            entity_id: button.220d_flash_lights
        style:
          top: 5%
          right: 3%
          color: rgb(68, 115, 158)
      - type: icon
        icon: mdi:bullhorn
        tap_action:
          action: call-service
          service: button.press
          service_data:
            entity_id: button.220d_sound_horn
        style:
          top: 12%
          right: 3%
          color: rgb(68, 115, 158)
      - type: icon
        icon: mdi:fan
        tap_action:
          action: call-service
          service: button.press
          service_data:
            entity_id: button.220d_activate_air_conditioning
        style:
          top: 19%
          right: 3%
          color: rgb(68, 115, 158)
      - type: icon
        icon: mdi:sync
        tap_action:
          action: call-service
          service: button.press
          service_data:
            entity_id: button.220d_refresh_from_cloud
        style:
          top: 26%
          right: 3%
          color: rgb(68, 115, 158)

      - type: state-icon
        entity: binary_sensor.bmw_220d_door_driver_front
        style:
          top: 50%
          right: 13%
      - type: state-icon
        entity: binary_sensor.bmw_220d_door_passenger_front
        style:
          top: 50%
          left: 17%
      - type: state-icon
        entity: binary_sensor.bmw_220d_door_driver_rear
        style:
          top: 70%
          right: 14%
      - type: state-icon
        entity: binary_sensor.bmw_220d_door_passenger_rear
        style:
          top: 70%
          left: 17%
      - type: state-icon
        entity: binary_sensor.bmw_220d_hood
        style:
          top: 3%
          left: 50%
      - type: state-icon
        entity: binary_sensor.bmw_220d_trunk
        style:
          bottom: -2%
          left: 46%

      - type: state-icon
        entity: binary_sensor.bmw_220d_window_driver_front
        style:
          top: 45%
          right: 13%
      - type: state-icon
        entity: binary_sensor.bmw_220d_window_passenger_front
        style:
          top: 45%
          left: 17%
      - type: state-icon
        entity: binary_sensor.bmw_220d_window_driver_rear
        style:
          top: 65%
          right: 14%
      - type: state-icon
        entity: binary_sensor.bmw_220d_window_passenger_rear
        style:
          top: 65%
          left: 17%

    
  - type: entities
    title: BMW 220d Gran Tourer
    state_color: true
    show_header_toggle: false
    entities:
      - entity: device_tracker.220d
        secondary_info: last-changed
        icon: mdi:car-connected
      - entity: binary_sensor.220d_check_control_messages
        secondary_info: last-changed
      - entity: binary_sensor.220d_condition_based_services
        secondary_info: last-changed
      - entity: binary_sensor.220d_door_lock_state
        secondary_info: last-changed
        icon: mdi:car-key
      - entity: binary_sensor.220d_windows
        secondary_info: last-changed
        icon: mdi:window-closed
      - entity: binary_sensor.220d_lids
        secondary_info: last-changed
        icon: mdi:car-door
      - entity: sensor.bmw_220d_mileage
        secondary_info: last-changed
      - entity: sensor.220d_remaining_fuel
        secondary_info: last-changed
      - entity: sensor.bmw_220d_remaining_fuel
        secondary_info: last-changed
      - entity: sensor.bmw_220d_mpg
        secondary_info: last-changed

  - type: custom:stack-in-card
    mode: vertical
    cards:
    - type: entities
      title: Astra Battery
      state_color: true
      show_header_toggle: false
      entities:
        - entity: sensor.astra_car_battery_voltage
          secondary_info: last-changed
        - entity: sensor.astra_car_battery_wifi_signal
          secondary_info: last-changed
        - entity: binary_sensor.astra_car_battery_network_status
          secondary_info: last-changed
        - entity: switch.astra_car_battery_deep_sleep_wake
          secondary_info: last-changed
        - entity: automation.astra_toggle_deep_sleep
          secondary_info: last-changed
    - type: gauge
      max: 15
      entity: sensor.astra_car_battery_voltage
      name: Astra Battery Voltage
      min: 0
      severity:
        green: 12
        yellow: 20
        red: 21
      theme: reverse_gauge_th

  - type: map
    entities:
      - person.laurent
      - person.div
      - device_tracker.220d
    hours_to_show: 24